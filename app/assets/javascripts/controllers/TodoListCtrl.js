// Generated by CoffeeScript 1.10.0
angular.module('todo').controller("TodoListCtrl", function($scope, $routeParams, TodoList, Todo) {
  var serverErrorHandler;
  $scope.init = function() {
    this.todoListService = new TodoList();
    this.todoService = new Todo(1);
    return $scope.list = this.todoListService.find($routeParams.list_id, function(res) {
      return $scope.totalTodos = res.totalTodos;
    });
  };
  $scope.addTodo = function(todoDescription) {
    var todo;
    todo = this.todoService.create({
      description: todoDescription,
      completed: false
    });
    $scope.list.todos.unshift(todo);
    return $scope.todoDescription = "";
  };
  $scope.deleteTodo = function(todo) {
    this.todoService["delete"](todo);
    return $scope.list.todos.splice($scope.list.todos.indexOf(todo), 1);
  };
  serverErrorHandler = function() {
    return alert("サーバーでエラーが発生しました。画面を更新し、もう一度試してください。");
  };
  $scope.toggleTodo = function(todo) {
    return this.todoService.update(todo, {
      completed: todo.completed
    });
  };
  return $scope.search = function() {
    var params;
    params = {
      'q[description_cont]': $scope.descriptionCont,
      'q[completed_true]': $scope.completedTrue,
      'page': $scope.currentPage
    };
    return $scope.list = this.todoService.all(params, function(res) {
      return $scope.totalTodos = res.totalTodos;
    });
  };
});
